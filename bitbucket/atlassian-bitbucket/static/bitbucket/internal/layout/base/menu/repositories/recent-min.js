define("bitbucket/internal/layout/base/menu/recent-repos","jquery lodash bitbucket/util/navbuilder bitbucket/internal/util/ajax bitbucket/internal/util/events bitbucket/internal/util/html bitbucket/internal/util/shortcuts exports".split(" "),function(a,h,k,l,d,m,n,p){p.initMenu=function(b){b=a("#"+b);var f=a("#"+m.sanitizeId(b.attr("aria-controls"))).addClass("recent-repositories-menu"),e=f.find(".recent-repositories-section ul"),g=a(bitbucket.internal.layout.menu.loadingRecentReposMenuItem());n.bind("recentRepositories",
h.ary(a.fn.click.bind(b),0));f.on("aui-dropdown2-show",function(){d.trigger("bitbucket.internal.ui.nav.repositories.opened")});f.on("click","a",function(){var c=a(this).closest(".aui-dropdown2-section");c.is(".recent-repositories-section")&&d.trigger("bitbucket.internal.ui.nav.repositories.item.clicked",null,{repositoryId:a(this).attr("data-repo-id")});c.is(".public-repo-list-link-section")&&d.trigger("bitbucket.internal.ui.nav.repositories.public.clicked")});e.append(g);a(window).on("load",function(){l.rest({url:k.rest().profile().recent().repos().withParams({avatarSize:bitbucket.internal.widget.avatarSizeInPx({size:"xsmall"})}).build(),
statusCode:{"*":function(){return!1}}}).done(function(c){if(c&&c.size){var b=c.values;b.sort(function(a,b){return a.project.name.localeCompare(b.project.name)||a.name.localeCompare(b.name)});e.append(a(bitbucket.internal.feature.repository.menuItems({repos:b})))}else e.append(a(bitbucket.internal.layout.menu.noRecentReposMenuItem()));d.trigger("bitbucket.internal.feature.repositories.recent.loaded",this,c)}).fail(function(){e.append(a(bitbucket.internal.layout.menu.errorLoadingRecentReposMenuItem()))}).always(function(){g.remove()})})}});