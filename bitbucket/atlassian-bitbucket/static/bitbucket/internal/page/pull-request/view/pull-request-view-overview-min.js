define("bitbucket/internal/page/pull-request/view/pull-request-view-overview","jquery lib/jsuri bitbucket/util/navbuilder bitbucket/internal/feature/comments/comment-tips bitbucket/internal/feature/discussion/participants-list bitbucket/internal/feature/pull-request/pull-request-activity bitbucket/internal/feature/watch bitbucket/internal/model/page-state bitbucket/internal/util/events bitbucket/internal/util/scroll bitbucket/internal/util/syntax-highlight".split(" "),function(d,z,A,p,B,q,r,f,h,C,
D){function t(a){var b=d(bitbucket.internal.feature.pullRequest.mergeConflictBanner({extraClasses:"transparent"})).prependTo(a).find(".manual-merge").click(function(a){a.preventDefault();h.trigger("bitbucket.internal.pull-request.show.cant.merge.help")}).end();setTimeout(function(){b.removeClass("transparent")},0)}function u(a){var b=f.getCurrentUser();b&&b.getName()===a.getUser().getName()&&k.setIsWatching(!0)}function v(a,b,g){if(c instanceof q){c.reset();c=null;var e=d(bitbucket.internal.feature.pullRequest.activity({id:"pull-request-activity",
currentUser:f.getCurrentUser()&&f.getCurrentUser().toJSON(),commentTips:p.tips})).find(".pull-request-activity");w().replaceWith(e)}c=new q(w(),a,b,g,{scrollableElement:window});c.init()}function w(){return d(e).find(".pull-request-activity")}function x(){var a=y();if(a.id&&a.type){var b;var g=a.type,c=a.id;b=d(e);g=b.find(g===E.COMMENT?'.comment[data-id\x3d"'+c+'"]':'.activity-item[data-activityid\x3d"'+c+'"]');g.length?(b.find(".comment.focused, .activity-item.focused").removeClass("focused"),g.addClass("focused"),
C.scrollTo(g),b=!0):b=!1;b||v(f.getPullRequest(),a.type,a.id)}}function y(){var a=new z(window.location);return{type:a.getQueryParamValue("commentId")?"comment":"activity",id:a.getQueryParamValue("commentId")||a.getQueryParamValue("activityId")}}var e,c,k,m,n=!1,l,E={COMMENT:"comment",ACTIVITY:"activity"};h.on("bitbucket.internal.pull-request.cant.merge",function(a,b,c){!n&&b&&e&&(n=!0,t(e))});return{load:function(a){e=a;var b=f.getPullRequest();a.innerHTML=bitbucket.internal.page.pullRequest.viewOverview({pullRequest:b.toJSON(),
author:b.getAuthor().getUser().toJSON(),createdDate:b.getCreatedDate(),description:b.getDescription(),descriptionAsHtml:b.getDescriptionAsHtml(),currentUser:f.getCurrentUser()&&f.getCurrentUser().toJSON(),commentTips:p.tips});D.container(d(a));n&&t(a);a=d(".watch a");var c=A.rest().currentPullRequest().watch().build();k=new r(a,c,r.type.PULL_REQUEST);l=b.getParticipants();l.on("add",u);m=new B(l,d("#participants-dropdown ul"),d(".participants.plugin-item"));a=y();v(b,a.type,a.id);h.on("bitbucket.internal.history.changestate",
x)},_internalActivity:function(){return c},unload:function(a){c.reset();c=null;d(a).empty();e=null;l.off("add",u);k.destroy();k=null;m.destroy();m=null;h.off("bitbucket.internal.history.changestate",x)},keyboardShortcutContexts:["pull-request-overview"]}});