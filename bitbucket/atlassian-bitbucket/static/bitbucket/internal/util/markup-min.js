define("bitbucket/internal/util/markup",["exports"],function(e){function q(b,a,c,d){b=b.indexOf(a,c||0);return-1===b||d&&b>d?null:b}function l(b){for(var a=0,c=[],d=!1,k=!1,e=/`/,g=/`|~/,l=/^(~~~+|```+[\S]*)/,t=/\\/,r=0;a<b.length;){var m=a,n=b[a++],h=n;"\n"===n&&(r=a,d&&(c.push({start:m,end:a,value:h,blockType:p.INLINE,type:f.CODE_END}),d=!1));if(g.test(n)){var u=b.substring(r,q(b,"\n",a)||b.length);if(l.test(u)){for(;"\n"!==b[a]&&a<b.length;)h+=b[a++];if(k){if(c[c.length-1].value.substring(0,3)!==
h.substring(0,3))continue;k=!1}else k=!0;c.push({start:m,end:a,value:h,blockType:p.FENCED,type:k?f.CODE_START:f.CODE_END})}else t.test(b[m-1])||k||!e.test(n)||(d=d?!1:!0,c.push({start:m,end:a,value:h,blockType:p.INLINE,type:d?f.CODE_START:f.CODE_END}))}}return c}var f={CODE_START:"CODE_START",CODE_END:"CODE_END"},p={INLINE:"INLINE",FENCED:"FENCED"};e.TokenTypes=f;e.BlockTypes=p;e.isPositionInsideCodeBlock=function(b,a){var c=l(a),d=!1;c.forEach(function(a,e){if(a.type===f.CODE_START&&a.start<b){var g=
c[e+1];if(g&&g.type===f.CODE_END&&g.blockType===a.blockType&&g.start>=b||!g)return d=!0,!1}});return d};e.codeBlockTokenizer=l;e.findNextTokenIndex=q});