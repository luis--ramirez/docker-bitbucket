define("bitbucket/internal/util/performance",["jquery"],function(l){function m(c,a){function d(){e=null;k=!0;b.fire();b=new l.Callbacks;k=!1;a()}var b=new l.Callbacks,k=!1,e=null;return{name:c,forceExecute:function(){e&&(clearTimeout(e),d())},queue:function(a){k?a():(b.add(a),e||(e=setTimeout(d,0)))}}}var g=m("READ",function(){f.forceExecute()}),f=m("WRITE",function(){g.forceExecute()});return{queueDOMRead:g.queue.bind(g),queueDOMWrite:f.queue.bind(f),enqueueCapped:function(c,a,d){d=d||1;var b=0;
return function(){b>=d||(b++,c(function(){try{return a.apply(this,arguments)}finally{b--}}))}},frameBatchedMap:function(c,a,d){a=l.extend({initial:500,min:10,max:Infinity},a);d=d||function(b){b()};return function(b){function k(){for(var a=Math.min(h+e,b.length);h<a;h++)g[h]=c(b[h])}var e=a.initial,f=l.Deferred(),h=0,g=[];requestAnimationFrame(function n(){if("pending"===f.state()){var c=(new Date).getTime();d(k);c=(new Date).getTime()-c;c=Math.ceil(15/c*e);e=Math.min(a.max,Math.max(a.min,c));h===
b.length?f.resolve(g):requestAnimationFrame(n)}});return f}}}});