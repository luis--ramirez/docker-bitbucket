define("bitbucket/internal/feature/repository/branch-selector-field-internals","aui jquery lodash bitbucket/internal/feature/repository/revision-reference-selector bitbucket/internal/model/revision-reference bitbucket/internal/util/events bitbucket/internal/widget/searchable-selector".split(" "),function(p,k,l,q,m,n,r){function t(){for(var b=[],a=e.length;a--;)e[a].$input.closest(document.body).length?b.push(e[a]):e[a].destroy();e=b}function u(b){if(!b||!l.isArray(b))return null;l.each(b,function(a){var b=
m.type.from(a.type);null!=b&&(a.type=b)});return r.constructDataPageFromPreloadArray(b)}var e=[];k(document).bind("hideLayer",function(){setTimeout(t,0)});n.on("bitbucket.internal.widget.branchselector.inputAdded",function(b,a){k(document).ready(function(){function g(){c=c.length?c:k("#"+b);c.length||console.log("Branch selector field (#"+b+") was not found and not initialised. See https://jira.atlassian.com/browse/STASH-3914");var h=c.nextAll(".remove-link"),d=u(a.preloadData),f=new q(c.prevAll(".branch-selector-field"),
{context:b,field:c,triggerPlaceholder:a.triggerPlaceholder,show:{tags:a.showTags},preloadData:d,extraClasses:a.extraClasses,paginationContext:"branch-selector-field"});a.revisionId&&((d=d&&l.findWhere(d.values,{id:a.revisionId}))?f.setSelectedItem(new m({id:d.id,displayId:d.displayId,type:d.type,isDefault:!1})):f.setSelectedItem(m.hydrateRefFromId(a.revisionId)));h.click(function(b){b.preventDefault();f.clearSelection();h.addClass("hidden")});var g=function(a){this===f&&(c.val(a?a.getId():""),n.trigger("bitbucket.component.branchSelector.change",
null,{elementId:b,ref:a?a.toJSON():null}),a.getType().id===m.type.TAG.id?h.text(p.I18n.getText("bitbucket.web.branch.selector.remove.tag")):h.text(p.I18n.getText("bitbucket.web.branch.selector.remove.branch")),h.toggleClass("hidden",!a))};n.on("bitbucket.internal.feature.repository.revisionReferenceSelector.revisionRefChanged",g);e.push({$input:c,destroy:function(){n.off("bitbucket.internal.feature.repository.revisionReferenceSelector.revisionRefChanged",g);f.destroy();f=null}})}var c;c=k("#"+b);
c.length?g():l.defer(g)})})});require("bitbucket/internal/feature/repository/branch-selector-field-internals");