define("bitbucket/internal/feature/pull-request/merge-help",["aui","bitbucket/util/navbuilder","bitbucket/internal/util/events"],function(l,h,b){function m(c,n,p,b){a||(a=l.dialog2(bitbucket.internal.feature.pullRequest.mergeHelpDialog()),a.$el.find(".dialog-close-button").click(function(){a.hide()}),a.$el.appendTo("body"));a.$el.find(".aui-dialog2-content").html(d(c,n,p))}function d(c,a,b,q){var f=c.getFromRef().getRepository(),g=c.getToRef().getRepository(),d=null,e=null;f.isEqual(g)||(d=h.project(f.getProject()).repo(f).clone(f.getScmId()).buildAbsolute(),
e=h.project(g.getProject()).repo(g).clone(g.getScmId()).buildAbsolute());c={sourceBranch:c.getFromRef().getDisplayId(),targetBranch:c.getToRef().getDisplayId(),sourceRemote:d,targetRemote:e,conflicted:a,vetoes:b};return q?bitbucket.internal.feature.pullRequest.mergeInstructionsForStableSourceBranch(c):bitbucket.internal.feature.pullRequest.mergeHelp(c)}function e(){a&&a.show()}var a,k=function(a,b,d,e){m(a,b,d,e)};return{init:function(){b.on("bitbucket.internal.pull-request.cant.merge",k);b.on("bitbucket.internal.pull-request.show.cant.merge.help",
e)},reset:function(){b.off("bitbucket.internal.pull-request.cant.merge",k);b.off("bitbucket.internal.pull-request.show.cant.merge.help",e);a&&(a.remove(),a=null)},mergeHelpConflictMarkup:function(a,b){return d(a,b,null,!0)}}});