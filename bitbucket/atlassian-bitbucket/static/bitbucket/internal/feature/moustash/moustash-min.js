define("bitbucket/internal/feature/moustash",["aui","jquery","lodash","exports"],function(e,c,f,a){function h(){var b=c.Deferred();d=new Image;d.onload=function(){b.resolve()};d.src=e.contextPath()+"/s/1/_/download/resources/com.atlassian.bitbucket.server.bitbucket-web:moustash/moustash.png";return b}var g=!1,d;a.loadResources=f.once(function(){return c.when(WRM.require("wr!com.atlassian.bitbucket.server.bitbucket-web:face-detection"),h()).done(function(){g=!0})});a.isReady=function(){return g};a.addToFaces=
function(b){if(!g)throw Error("Face-detection resources not loaded yet");var a=require("lib/ccv/ccv"),c=require("lib/ccv/face-cascade"),a=a.detect_objects({canvas:b,cascade:c,interval:5,min_neighbors:1}),e=b.getContext("2d");f.each(a,f.bind(function(a){.1<a.width/b.width&&e.drawImage(d,a.x+.05*a.width,a.y+.675*a.height,.9*a.width,.2*a.height)}))}});