define("bitbucket/internal/feature/comments",["jquery","bitbucket/internal/feature/comments/activity-comment-context","bitbucket/internal/feature/comments/anchors","bitbucket/internal/feature/comments/comment-tips","bitbucket/internal/feature/comments/diff-comment-context"],function(e,g,f,h,k){var c={CREATE_NEW:"create-new",REPLY_ONLY:"reply-only",READ:"read",NONE:"none"};return e.extend({bindContext:function(a,d,b){if(a.data("comment-context"))throw Error("Duplicate comment context registered.");
b=e.extend({el:a[0],anchor:d,allowCommenting:b&&b.commentMode===c.CREATE_NEW,showComments:b&&(b.commentMode===c.READ||b.commentMode===c.CREATE_NEW||b.commentMode===c.REPLY_ONLY)},b);d=d instanceof f.DiffAnchor?new k(b):new g(b);a.data("comment-context",d);return d},updateContext:function(a){(a=a.data("comment-context"))&&a.checkForNewContainers()},unbindContext:function(a){(a=a.data("comment-context"))&&a.destroy()},commentMode:c},f,h)});