define("bitbucket/internal/feature/file-content/diff-view-context/diff-view-context-internal","jquery lodash bitbucket/internal/feature/file-content/diff-view-segment-types bitbucket/internal/model/file-change-types bitbucket/internal/util/function exports".split(" "),function(n,h,e,q,t,k){var u={destinationLine:1,destinationSpan:0,sourceLine:1,sourceSpan:0},r=t.eq(e.ADDED);k.isAdded=r;k.getSeparatedHunkHtml=function(b,f,l){function d(a){return{line:g?a.destinationLine:a.sourceLine,span:g?a.destinationSpan:
a.sourceSpan}}var c;a:switch(f){case q.ADD:c=e.ADDED;break a;case q.DELETE:c=e.REMOVED;break a;default:c=e.CONTEXT}var g=r(c);return h.map(h.zip([u].concat(b),b.concat({})),function(a){var b=d(a[0]),m=d(a[1]),p=1<m.line,v=0<b.span,b=b.line+b.span,m=m.line-1;g?a=0:(a=a[0],a=a.sourceLine+a.sourceSpan-(a.destinationLine+a.destinationSpan));return l(b,m,a,c,p,v)})};k.fetchContext=function(b,f,l,d,c){function g(a,p,b){return a&&h.extend({},a,{lines:a.lines.slice(p,b)})}var a=isNaN(f)?c.maxLimit:f-b+1,
e=function(c){return n.when(0===b?null:c(b,d+(f?0:1)),f?c(b+a-d,d):null).then(function(a,b){if(b)return a?{startSep:a.start+d,endSep:b.start,contexts:[a,b]}:{startSep:0,endSep:b.start,contexts:[null,b]};var c=a.lines.length>d;return{startSep:a.start+a.lines.length+(c?-1:0),contexts:c?[g(a,0,-1),null]:[a]}})};return a<c.maxLimit?l(b,a).then(function(b){return a<=2*d?n.Deferred().resolve({startSep:0,endSep:0,contexts:[b]}):e(function(a){return n.Deferred().resolve({start:a,lines:b.lines})}).then(function(a){return h.extend({},
a,{contexts:[g(a.contexts[0],0,d),g(a.contexts[1],-d)]})})}):e(l)};k.toHunks=function(b,f){return function(e){var d=[];h.each(e.contexts,function(c){c&&d.push({segments:[{type:f,lines:h.map(c.lines,function(b){return{line:b.text}})}],sourceLine:c.start+1,destinationLine:c.start+1-b,isLastPage:c.isLastPage})});return d.length?d:""}}});