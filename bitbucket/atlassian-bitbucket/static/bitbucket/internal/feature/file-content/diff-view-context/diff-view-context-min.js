define("bitbucket/internal/feature/file-content/diff-view-context","aui jquery lodash bitbucket/util/navbuilder bitbucket/internal/feature/file-content/diff-view-context/diff-view-context-internal bitbucket/internal/model/file-change bitbucket/internal/util/ajax bitbucket/internal/util/dom-event bitbucket/internal/util/navigator exports".split(" "),function(a,q,n,p,e,d,r,t,f,h){function g(a,b,e,u,c,l){return c||l?bitbucket.internal.feature.fileContent.hunkSeparator({tooltip:v,lineStart:a,lineEnd:b,
destOffset:e,changeType:u,isBelow:c,isAbove:l}):""}var v=f.isMac()?a.I18n.getText("bitbucket.web.diffview.showmore.tooltip.cmd"):a.I18n.getText("bitbucket.web.diffview.showmore.tooltip.ctrl");a=p.parse(location.href).getQueryParamValue("context");var m={maxLimit:f.isIE()?1E3:5E3,maxContext:a&&parseInt(a,10)||10};h.attachExpandContext=function(a,b,f){b=new d(b);return a.on("click",".skipped-container:not(.loading)",function(a){a.preventDefault();var c=q(a.currentTarget);c.addClass("loading");c.find(".showmore span").html("\x26nbsp;");
var l=c.find(".showmore").spin("small"),h=c.data("change-type"),d=c.data("dest-offset");a=t.isCtrlish(a)?m.maxLimit-1:m.maxContext;var g=c.data("line-start")-1,k=c.data("line-end")-1;e.fetchContext(g,k,function(a,f){var d=b.getDiff()&&b.getDiff().properties||{},g=b.getCommitRange().getSinceRevision(),k=b.getCommitRange().getUntilRevision();return r.rest({statusCode:{200:function(b,c,e,d){if(d&&d.message&&0<d.message.replace(/,/g,"").indexOf(" "+a+" "))return{promise:function(){return{lines:[]}}}}},
url:p.currentRepo().browse().path(b.getSrcPath()&&""!==b.getSrcPath().toString()?b.getSrcPath():b.getPath()).at(e.isAdded(h)?d.toHash||k.getId():d.fromHash||g&&g.getId()||k.getParents()[0].getId()).withParams({start:a,limit:f}).build()}).then(n.identity).always(function(){l.spinStop()}).fail(function(){c.removeClass("loading")})},a,m).then(e.toHunks(d,h)).then(n.bind(f,null,b,c))})};h.getSeparatedHunkHtml=function(a,b){return e.getSeparatedHunkHtml(a,b,g)}});