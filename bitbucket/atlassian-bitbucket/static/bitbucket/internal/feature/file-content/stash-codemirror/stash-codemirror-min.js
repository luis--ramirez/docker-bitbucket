define("bitbucket/internal/feature/file-content/stash-codemirror","aui codemirror jquery lodash bitbucket/internal/util/function bitbucket/internal/feature/file-content/stash-codemirror/stash-scrollbar".split(" "),function(m,h,d,e,f){function n(c){c.on("keydown",function(b,a){33<=a.which&&40>=a.which&&!a.shiftKey&&!b.somethingSelected()&&(37>a.which&&a.preventDefault(),b.getInputField().blur())})}function p(c){var b=!1,a=f.lazyDelay(function(){var a;b||(a=c.lineAtHeight(c.getScrollInfo().top+c.heightAtLine(0)),
c.setSelection({line:a+1,ch:0}));b=!1},10);c.on("contextmenu",function(){b=!0});c.on("blur",function(c){c.somethingSelected()&&a();b=!1})}function q(c){c.on("keydown",g);c.on("keypress",g)}function g(c,b){var a=e.extend(jQuery.Event(b.type),e.pick(b,r));d(document).trigger(a);b.codemirrorIgnore=!!k[b.which||b.keyCode]}function t(c){var b={},a=Array.prototype.slice.call(arguments,1),d=f.spread(function(a,l){b[a]=void 0!==l?e.compose(f.constant(l),c[a].bind(c)):c[a].bind(c)});a.forEach(f.unary(d));
return b}h.defineOption("stashDestroyables",null);var k={};k[m.keyCode.TAB]=!0;var r=["which","keyCode","shiftKey","ctrlKey","metaKey"];return function(c,b){var a=new h(c,d.extend({mode:"text/plain",readOnly:!0,lineNumbers:!1,wholeLineUpdateBefore:!1,scrollbarStyle:b.scrollStyle?"stash-"+b.scrollStyle:"native",cursorBlinkRate:0,styleSelectedText:!0,stashDestroyables:[],theme:"stash-default"},{viewportMargin:b&&b.autoResizing?Infinity:void 0},b));d(a.getWrapperElement()).find(".CodeMirror-lines, .CodeMirror-code").attr("data-skate-ignore",
"true");b&&b.autoResizing&&(c.className+=" codemirror-auto-resizing-container");n(a);q(a);p(a);var g=t(a,["addLineClass",this],"addLineWidget","charCoords","execCommand","getDoc","getInputField","getLine","getLineHandle","getLineNumber","getOption","getScrollInfo","getWrapperElement","heightAtLine","lastLine","lineAtHeight",["markText",this],["off",this],["on",this],["refresh",this],["removeLineClass",this],"replaceRange",["scrollIntoView",this],["scrollTo",this],["setGutterMarker",this],["setOption",
this],["setSelection",this],["setValue",this]);d.extend(this,g);this.operation=function(b){a.operation(f.unary(e.partial(b,this)));return this};this.destroy=function(){e.invoke(a.getOption("stashDestroyables"),"destroy");d(a.getWrapperElement()).remove()};this._highlight=function(b){h.commands.highlight(a,b)};this._insert=function(b,c,d){var e=0===c;--c;var f=a.getOption("wholeLineUpdateBefore");a.setOption("wholeLineUpdateBefore",e);var g=a.getDoc(),h={line:c,ch:e?0:a.getLine(c).length};g.replaceRange(e?
b+"\n":"\n"+b,h);d&&g.setSelection({line:c,ch:0});a.setOption("wholeLineUpdateBefore",f)};return this}});