define("bitbucket/internal/test/waiter",["jquery","lodash","bitbucket/internal/util/promise"],function(f,g,d){return function(b){function e(a){var c=f.Deferred();a.initialWait?setTimeout(c.resolve.bind(c),a.initialWait):c.resolve();return c.promise().then(d.waitFor.bind(d,g.pick(a,["predicate","timeout","interval"]))).then(b.ok.bind(b,!0,a.message)).fail(b.ok.bind(b,!1,a.message))}var h=b.async();return{waitFor:e,thenWaitFor:function(a){return e.bind(null,a)},resume:h}}});