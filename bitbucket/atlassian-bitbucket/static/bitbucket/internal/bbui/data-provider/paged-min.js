define("bitbucket/internal/bbui/data-provider/paged","module exports jquery bitbucket/internal/impl/data-provider/data-provider ../javascript-errors/javascript-errors ../json-validation/json-validation".split(" "),function(m,d,g,n,h,p){Object.defineProperty(d,"__esModule",{value:!0});var k=babelHelpers.interopRequireDefault(g);g=babelHelpers.interopRequireDefault(n);var l=babelHelpers.interopRequireDefault(h),q=babelHelpers.interopRequireDefault(p);h=function(d){function e(){var a,b=0>=arguments.length||
void 0===arguments[0]?{}:arguments[0];babelHelpers.classCallCheck(this,e);for(var c=arguments.length,d=Array(1<c?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];c=babelHelpers.possibleConstructorReturn(this,(a=Object.getPrototypeOf(e)).call.apply(a,[this,b].concat(d)));c._lastPageData=null;b.filterDescriptor&&(c._validateFilter=(0,q.default)(b.filterDescriptor));c.filter=b.filter||{};c._validateFilter(c.filter);return c}babelHelpers.inherits(e,d);babelHelpers.createClass(e,[{key:"_validateFilter",value:function(a){if(Object.keys(a).length)throw Error("No filter is expected on this data-provider.");
}},{key:"setFilter",value:function(a,b){this.filter&&(this.filter[a]=b);this._validateFilter&&this._validateFilter(this.filter)}},{key:"fetchNext",value:function(){var a=this;if(this.reachedEnd)throw Error("Nothing left to fetch.");this.abort();if(this.initialData)return this._lastPageData=this.initialData,this.currentData=this.transform(this.initialData),delete this.initialData,k.default.Deferred().resolve(this.currentData);this.trigger("data-requested");this._requestPromise=this._fetchNext(this._lastPageData);
if(!this._requestPromise.abort)throw Error("no abort method on PagedDataProvider#_requestPromise.");this._requestPromise.then(function(b){a._lastPageData=b});return this._requestPromise.then(this.transform,function(){return k.default.Deferred().reject(a.errorTransform.apply(a,arguments))}).done(function(b){a.trigger("data-loaded",b);a.currentData=b}).fail(function(b){a.trigger("data-request-failed",b)}).always(function(){a._requestPromise=null})}},{key:"reset",value:function(){this._lastPageData=
null;babelHelpers.get(Object.getPrototypeOf(e.prototype),"reset",this).call(this)}},{key:"_fetchNext",value:function(a){throw new l.default.NotImplementedError;}},{key:"_reachedEnd",value:function(a){throw new l.default.NotImplementedError;}},{key:"reachedEnd",get:function(){return this._lastPageData?this._reachedEnd(this._lastPageData):!1}}]);return e}(g.default);d.default=h;m.exports=d["default"]});