define("bitbucket/internal/bbui/pull-request-header/components/merge","module exports react jquery lodash ../../aui-react/inline-dialog ../../models/models ./merge-button ./merge-help-dialog".split(" "),function(k,f,a,h,l,m,n,p,q){Object.defineProperty(f,"__esModule",{value:!0});var d=babelHelpers.interopRequireDefault(a),g=babelHelpers.interopRequireDefault(h),r=babelHelpers.interopRequireDefault(l),t=babelHelpers.interopRequireDefault(m),u=babelHelpers.interopRequireDefault(p),v=babelHelpers.interopRequireDefault(q);
h=function(f){function e(){var c;babelHelpers.classCallCheck(this,e);for(var b=arguments.length,d=Array(b),a=0;a<b;a++)d[a]=arguments[a];b=babelHelpers.possibleConstructorReturn(this,(c=Object.getPrototypeOf(e)).call.apply(c,[this].concat(d)));b.state={};return b}babelHelpers.inherits(e,f);babelHelpers.createClass(e,null,[{key:"propTypes",get:function(){return{conditions:a.PropTypes.object.isRequired,mergeHelp:a.PropTypes.object,onMergeClick:a.PropTypes.func.isRequired,onMergeHelpDialogClose:a.PropTypes.func,
pullRequest:a.PropTypes.object.isRequired,showMergeHelpDialog:a.PropTypes.bool}}}]);babelHelpers.createClass(e,[{key:"componentDidMount",value:function(){var c=this;this.mergeWarningDialog=document.getElementById("merge-warning-inline-dialog");this.throttledWarningDialogHide=r.default.throttle(function(){c.mergeWarningDialog&&(c.mergeWarningDialog.open=!1)},50);(0,g.default)(window).on("scroll resize",this.throttledWarningDialogHide);this.onToggleMergeWarningDialog=function(b){c.setState({mergeWarningDialogOpen:"aui-show"===
b.type?!0:!1})};(0,g.default)(this.mergeWarningDialog).on("aui-show aui-hide",this.onToggleMergeWarningDialog)}},{key:"componentWillReceiveProps",value:function(c){this.setState({mergeHelpDialogShowing:c.showMergeHelpDialog})}},{key:"componentWillUnmount",value:function(){(0,g.default)(window).off("scroll resize",this.throttledWarningDialogHide);(0,g.default)(this.mergeWarningDialog).off("aui-show aui-hide",this.onToggleMergeWarningDialog)}},{key:"onHideMergeHelpDialog",value:function(){this.extendedMergeHelpContent=
"";this.setState({mergeHelpDialogShowing:!1});if(this.props.onMergeHelpDialogClose)this.props.onMergeHelpDialogClose()}},{key:"onMergeWarningClick",value:function(){this.toggleMergeWarningDialog()}},{key:"toggleMergeWarningDialog",value:function(c){null==c&&(c=!this.mergeWarningDialog.open);this.mergeWarningDialog.open=c}},{key:"showExtendedMergeHelp",value:function(){this.setState({mergeHelpDialogShowing:!0})}},{key:"render",value:function(){var c=this,b=this.props.pullRequest;if(b.state===n.PullRequestState.OPEN&&
b.mergeable&&this.props.conditions.canMerge){var a=b.mergeable.vetoes&&[].concat(b.mergeable.vetoes);b.mergeable.conflicted&&a.unshift({detailedMessage:AJS.I18n.getText("bitbucket.component.pull.request.merge.conflict.detail"),isConflictVeto:!0});var e=void 0;this.state.mergeHelpDialogShowing&&(e=d.default.createElement(v.default,{id:"extended-merge-help-dialog",onHide:function(){return c.onHideMergeHelpDialog()},pullRequest:b,stability:this.props.mergeHelp&&this.props.mergeHelp.stability,isAutoMergeConflict:this.props.mergeHelp&&
this.props.mergeHelp.isAutoMergeConflict}));a=d.default.createElement(t.default,{key:"merge-warning-dialog",id:"merge-warning-inline-dialog",alignment:"bottom"},d.default.createElement("div",{className:"merge-warning-content"},d.default.createElement("h6",null,AJS.I18n.getText("bitbucket.component.pull.request.merge.warnings.title")),d.default.createElement("p",null,AJS.I18n.getText("bitbucket.component.pull.request.merge.warnings.info",a&&a.length)),d.default.createElement("ul",{className:"aui-list-truncate"},
a&&a.map(function(a,b){var e=void 0===a.isConflictVeto?null:d.default.createElement("button",{className:"aui-button aui-button-link more-info",onClick:function(){return c.showExtendedMergeHelp()}},AJS.I18n.getText("bitbucket.component.pull.request.merge.warnings.more.button"));return d.default.createElement("li",{key:"merge-issue-"+b},d.default.createElement("span",{className:"message"},d.default.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-warning"}),a.detailedMessage),e)}))));
return d.default.createElement("div",null,d.default.createElement(u.default,{onMergeClick:this.props.onMergeClick,onMergeWarningClick:function(){return c.onMergeWarningClick()},mergeable:b.mergeable,conflicted:b.mergeable.conflicted,vetoes:b.mergeable.vetoes,extraButtonProps:{"aria-controls":"merge-warning-inline-dialog","aria-haspopup":!0},tooltipVisibility:!this.state.mergeWarningDialogOpen}),a,e)}return null}}]);return e}(a.Component);f.default=h;k.exports=f["default"]});