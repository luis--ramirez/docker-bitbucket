define("bitbucket/internal/bbui/pull-request-list/pull-request-list","module exports jquery lodash react react-dom bitbucket/internal/impl/urls ../aui-react/avatar ../aui-react/icon ../filter-bar/filter-bar ../models/models ../pull-request-list-table/pull-request-list-table ./dom-event".split(" "),function(v,k,l,w,b,x,y,z,A,B,C,D,E){function p(b,d,m){q.default.render(a.default.createElement(F.default,{person:d,size:"selection"===b?"xsmall":"small",withName:!0,withEmail:"result"===b,className:"pull-request-list-filter filter-"+
b}),m[0])}function r(b,d,m){q.default.render(a.default.createElement("span",{className:"pull-request-list-filter filter-"+b},a.default.createElement(G.default,{size:"small",icon:"devtools-branch"},AJS.I18n.getText("bitbucket.component.pull.request.list.branch")),a.default.createElement("span",{className:"name",title:d.display_id},d.display_id)),m[0])}Object.defineProperty(k,"__esModule",{value:!0});var H=babelHelpers.interopRequireDefault(l),g=babelHelpers.interopRequireDefault(w),a=babelHelpers.interopRequireDefault(b),
q=babelHelpers.interopRequireDefault(x),f=babelHelpers.interopRequireDefault(y),F=babelHelpers.interopRequireDefault(z),G=babelHelpers.interopRequireDefault(A),e=babelHelpers.interopRequireDefault(B),n=babelHelpers.interopRequireDefault(C),I=babelHelpers.interopRequireDefault(D),J=babelHelpers.interopRequireDefault(E),t=function(b){return a.default.createElement("div",{className:"pull-request-intro"},a.default.createElement("div",{className:"intro-image"}),a.default.createElement("div",{className:"intro-text"},
a.default.createElement("h3",null,AJS.I18n.getText("bitbucket.component.pull.request.list.intro.title")),a.default.createElement("p",null,AJS.I18n.getText("bitbucket.component.pull.request.list.intro.description"))),a.default.createElement("div",{className:"intro-buttons"},a.default.createElement("a",{id:"empty-list-create-pr-button",className:"aui-button aui-button-primary",href:f.default.createPullRequest(b.repository)},AJS.I18n.getText("bitbucket.component.pull.request.list.intro.button.create")),
a.default.createElement("a",{id:"empty-list-help-button",className:"aui-button aui-button-link help-button",target:"_blank",href:f.default.help("help.pull.request")},AJS.I18n.getText("bitbucket.component.pull.request.list.intro.button.help"))))};t.propTypes={repository:b.PropTypes.object};var u=function(b){return a.default.createElement("div",{className:"empty-banner-content"},a.default.createElement("h3",null,b.filtered?AJS.I18n.getText("bitbucket.component.pull.request.filtered.no.matches"):AJS.I18n.getText("bitbucket.component.pull.request.no.open")),
a.default.createElement("p",{dangerouslySetInnerHTML:{__html:b.filtered?AJS.I18n.getText("bitbucket.component.pull.request.filtered.no.matches.description",'\x3ca id\x3d"reset-filters" href\x3d"'+f.default.allPullRequests(b.repository)+'"\x3e',"\x3c/a\x3e"):AJS.I18n.getText("bitbucket.component.pull.request.no.open.description",'\x3ca href\x3d"'+f.default.createPullRequest(b.repository)+'"\x3e',"\x3c/a\x3e")},onClick:function(a){(0,H.default)(a.target).closest("#reset-filters").length&&(0,J.default)(a)&&
(b.onResetFilters(),a.preventDefault())}}))};u.propTypes={filtered:b.PropTypes.bool.isRequired,repository:b.PropTypes.object,onResetFilters:b.PropTypes.func};l=function(f){function d(){var b;babelHelpers.classCallCheck(this,d);for(var a=arguments.length,c=Array(a),h=0;h<a;h++)c[h]=arguments[h];a=babelHelpers.possibleConstructorReturn(this,(b=Object.getPrototypeOf(d)).call.apply(b,[this].concat(c)));a.onFilterChange=a.onFilterChange.bind(a);a.resetFilters=a.resetFilters.bind(a);return a}babelHelpers.inherits(d,
f);babelHelpers.createClass(d,null,[{key:"propTypes",get:function(){var a=["id","label"];return{allFetched:b.PropTypes.bool.isRequired,currentUser:b.PropTypes.any,initialFilter:b.PropTypes.shape({state:b.PropTypes.shape(g.default.omit(e.default.Select.propTypes,a)).isRequired,author:b.PropTypes.shape(g.default.omit(e.default.AsyncSelect.propTypes,a)).isRequired,target_ref:b.PropTypes.shape(g.default.omit(e.default.AsyncSelect.propTypes,a)).isRequired,reviewer_self:b.PropTypes.shape(g.default.omit(e.default.Toggle.propTypes,
a)).isRequired}),focusedIndex:b.PropTypes.number,gettingStarted:b.PropTypes.bool,loading:b.PropTypes.bool.isRequired,onFilterChange:b.PropTypes.func.isRequired,onMorePrsRequested:b.PropTypes.func.isRequired,pullRequests:b.PropTypes.array.isRequired,repository:b.PropTypes.any.isRequired,selectedAuthor:b.PropTypes.any,selectedTargetBranch:b.PropTypes.any}}}]);babelHelpers.createClass(d,[{key:"componentWillMount",value:function(){if(!this.props.pullRequests.length&&!this.props.allFetched)this.props.onMorePrsRequested();
this.setState({isFiltered:!!this.props.initialFilter.state.value&&"OPEN"!==this.props.initialFilter.state.value||!!this.props.initialFilter.author.value||!!this.props.initialFilter.target_ref.value||!!this.props.initialFilter.reviewer_self.value})}},{key:"onFilterChange",value:function(a){var b=this,c={state:a["pr-state-filter"],author_id:a["pr-author-filter"]||null,target_ref_id:a["pr-target-branch-filter"]||null,reviewer_self:a["pr-reviewer-self-filter"]};this.setState({isFiltered:"OPEN"!==c.state||
!!c.author_id||!!c.target_ref_id||!!c.reviewer_self},function(){return b.props.onFilterChange(c)})}},{key:"resetFilters",value:function(){this._filterBar&&this._filterBar.reset()}},{key:"render",value:function(){var b=this,d=!this.props.loading&&0===this.props.pullRequests.length,c=[];d&&this.props.gettingStarted?c.push(a.default.createElement(t,{key:"getting-started",repository:this.props.repository})):(c.push(a.default.createElement(e.default,{key:"filter-bar",onChange:this.onFilterChange,ref:function(a){return b._filterBar=
a}},a.default.createElement(e.default.Select,babelHelpers.extends({},this.props.initialFilter.state,{id:"pr-state-filter",label:AJS.I18n.getText("bitbucket.component.pull.request.list.state"),menu:{items:[{id:n.default.PullRequestState.OPEN,text:AJS.I18n.getText("bitbucket.component.pull.request.list.state.open")},{id:n.default.PullRequestState.MERGED,text:AJS.I18n.getText("bitbucket.component.pull.request.list.state.merged")},{id:n.default.PullRequestState.DECLINED,text:AJS.I18n.getText("bitbucket.component.pull.request.list.state.declined")}]}})),
a.default.createElement(e.default.AsyncSelect,babelHelpers.extends({},this.props.initialFilter.author,{id:"pr-author-filter",label:AJS.I18n.getText("bitbucket.component.pull.request.list.author"),searchPlaceholder:AJS.I18n.getText("bitbucket.component.pull.request.list.search.author"),menu:{id:function(a){return a.name},initSelection:function(a,d){var c=a.val();if(b.props.initialFilter.author.value===c)return d(b.props.selectedAuthor);throw Error("Unexpected value '"+c+"' when initializing the author filter.");
},formatSelection:p.bind(null,"selection"),formatResult:p.bind(null,"result"),formatNoMatches:function(){return AJS.I18n.getText("bitbucket.component.pull.request.list.search.author.nomatches")},placeholder:AJS.I18n.getText("bitbucket.component.pull.request.list.author"),dropdownCssClass:"pr-author-dropdown"}})),a.default.createElement(e.default.AsyncSelect,babelHelpers.extends({},this.props.initialFilter.target_ref,{id:"pr-target-branch-filter",label:AJS.I18n.getText("bitbucket.component.pull.request.list.branch.target"),
searchPlaceholder:AJS.I18n.getText("bitbucket.component.pull.request.list.search.branch"),menu:{initSelection:function(a,d){var c=a.val();if(b.props.initialFilter.target_ref.value===c)return d(b.props.selectedTargetBranch);throw Error("Unexpected value '"+c+"' when initializing the target branch filter.");},formatSelection:r.bind(null,"selection"),formatResult:r.bind(null,"result"),formatNoMatches:function(){return AJS.I18n.getText("bitbucket.component.pull.request.list.search.branch.nomatches")},
placeholder:AJS.I18n.getText("bitbucket.component.pull.request.list.branch.target"),dropdownCssClass:"pr-target-branch-dropdown"}})),this.props.currentUser&&a.default.createElement(e.default.Toggle,babelHelpers.extends({},this.props.initialFilter.reviewer_self,{id:"pr-reviewer-self-filter",label:AJS.I18n.getText("bitbucket.component.pull.request.list.reviewer.self")})))),c.push(d?a.default.createElement(u,{key:"no-results",filtered:this.state.isFiltered,repository:this.props.repository,onResetFilters:this.resetFilters}):
a.default.createElement(I.default,{key:"table",focusedIndex:this.props.focusedIndex,pullRequests:this.props.pullRequests,allFetched:this.props.allFetched,onMoreItemsRequested:this.props.onMorePrsRequested,loading:this.props.loading})));return a.default.createElement("div",{className:"pull-request-list"},c)}}]);return d}(b.Component);k.default=l;v.exports=k["default"]});