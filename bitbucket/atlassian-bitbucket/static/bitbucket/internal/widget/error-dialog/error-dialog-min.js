define("bitbucket/internal/widget/error-dialog",["aui","jquery"],function(c,d){function a(a){this._okCallbacks=d.Callbacks();this._closeCallbacks=d.Callbacks();this.reinit(a);var b=this;d(document).bind("hideLayer",function(a,f){b._dialog&&b._dialog.popup===f&&b.hide()})}a.prototype.reinit=function(f){this.dialogOptions=d.extend({},a.dialogDefaults,f);return this};a.prototype._createDialog=function(){if(!this._dialog){var a=this,b=this.dialogOptions,e=this._dialog=new c.Dialog({width:433,height:230,
id:b.id,closeOnOutsideClick:b.closeOnOutsideClick,keypressListener:function(b){b.keyCode===c.keyCode.ESCAPE&&a.hide()}}),g=this._okCallbacks;e.popup.element.addClass("error-dialog");e.addHeader(b.titleText,b.titleClass);e.addPanel("",b.panelContent,b.panelClass);e.addButton(b.okButtonText,function(b){b=d.Event("ok");g.fireWith(a,[b]);b.isDefaultPrevented()||a.remove()},"button "+(b.okButtonClass||""));b.showCloseButton&&e.addCancel(b.closeButtonText,function(b){a.remove()})}};a.prototype.show=function(){this._createDialog();
this._dialog.show();return this};a.prototype.isShowing=function(){return this._dialog&&this._dialog.popup.element.is(":visible")};a.prototype.hide=function(){this.isShowing()&&(this._dialog.hide(),this._closeCallbacks.fireWith(this,[]));return this};a.prototype.remove=function(){this._dialog&&(this.hide(),this._dialog.remove(),this._dialog=null);return this};a.prototype.addOkListener=function(a){this._okCallbacks.add(a);return this};a.prototype.addHideListener=function(a){this._closeCallbacks.add(a);
return this};a.prototype.getOkButton=function(){this._createDialog();return this._dialog.popup.element.find("."+this.dialogOptions.okButtonClass)};a.dialogDefaults={id:void 0,titleText:c.I18n.getText("bitbucket.web.dialog.unexpected.error.title"),titleClass:"error-header",panelContent:"\x3cp\x3e"+c.I18n.getText("bitbucket.web.dialog.unknown.error.detail")+"\x3c/p\x3e",panelClass:"panel-body",okButtonText:c.I18n.getText("bitbucket.web.dialog.button.ok"),okButtonClass:"ok-button",showCloseButton:!1,
closeButtonText:c.I18n.getText("bitbucket.web.dialog.button.close"),closeOnOutsideClick:!1};return a});