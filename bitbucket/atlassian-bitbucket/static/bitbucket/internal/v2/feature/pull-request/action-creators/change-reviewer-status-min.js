define("bitbucket/internal/v2/feature/pull-request/action-creators/change-reviewer-status","lodash bitbucket/util/events bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/bbui/actions/pull-request bitbucket/internal/bbui/models/models bitbucket/internal/model-transformer".split(" "),function(f,g,h,k,l,d,m){function n(b){function c(a,c){g.trigger(a,null,f.merge(b,{approved:c}))}if(b.newStatus!==d.ApprovalState.APPROVED&&b.oldStatus!==d.ApprovalState.APPROVED)b.request.then(function(){var a=
b.newStatus===d.ApprovalState.NEEDS_WORK;c("bitbucket.internal.widget.needs-work."+(a?"added":"removed"),a)});else{var a=b.newStatus===d.ApprovalState.APPROVED,e=a?{ing:"bitbucket.internal.widget.approve-button.adding",ed:"bitbucket.internal.widget.approve-button.added",failed:"bitbucket.internal.widget.approve-button.add.failed"}:{ing:"bitbucket.internal.widget.approve-button.removing",ed:"bitbucket.internal.widget.approve-button.removed",failed:"bitbucket.internal.widget.approve-button.remove.failed"};
c(e.ing,a);b.request.then(function(){c(e.ed,a)},function(){c(e.failed,!a)})}}return function(b){var c=b.pullRequest._stash,a=c.toRef.repository,e=a.project,d=b.user._stash,a=k.rest({type:"PUT",url:h.rest().project(e).repo(a).pullRequest(c).participants(d).withParams({avatarSize:bitbucket.internal.widget.avatarSizeInPx({size:"xsmall"})}).build(),data:{status:b.newStatus}});b=f.merge(b,{request:a,prId:Number(c.id),user:d});n(b);return{type:l.PR_CHANGE_REVIEWER_STATE,payload:{pullRequest:b.pullRequest,
user:b.user,newState:b.newStatus},meta:{promise:a.then(function(a){g.trigger("bitbucket.internal.feature.pullRequest.reviewerStatus.changed",null,{pullRequest:c,user:a.user,newState:a.status,oldState:b.oldStatus});return{pullRequest:b.pullRequest,user:m.user(a.user),newState:a.status}})}}}});