define("bitbucket/internal/v2/page/pull-request/view/pull-request-view-overview","jquery lib/jsuri bitbucket/internal/feature/comments/comment-tips bitbucket/internal/feature/discussion/participants-list bitbucket/internal/model/page-state bitbucket/internal/util/events bitbucket/internal/util/scroll bitbucket/internal/util/syntax-highlight bitbucket/internal/v2/feature/pull-request/pull-request-activity".split(" "),function(d,v,l,w,g,f,x,y,m){function n(a){var b=d(bitbucket.internal.feature.pullRequest.mergeConflictBanner({extraClasses:"transparent"})).prependTo(a).find(".manual-merge").click(function(a){a.preventDefault();
f.trigger("bitbucket.internal.pull-request.show.cant.merge.help")}).end();setTimeout(function(){b.removeClass("transparent")},0)}function p(a,b,z){if(c instanceof m){c.reset();c=null;var e=d(bitbucket.internal.feature.pullRequest.activity({id:"pull-request-activity",currentUser:g.getCurrentUser()&&g.getCurrentUser().toJSON(),commentTips:l.tips})).find(".pull-request-activity");q().replaceWith(e)}c=new m(q(),a,b,z,{scrollableElement:window});c.init()}function q(){return d(e).find(".pull-request-activity")}
function r(){var a=t();if(a.id&&a.type){var b;var c=a.type,f=a.id;b=d(e);c=b.find(c===A.COMMENT?'.comment[data-id\x3d"'+f+'"]':'.activity-item[data-activityid\x3d"'+f+'"]');c.length?(b.find(".comment.focused, .activity-item.focused").removeClass("focused"),c.addClass("focused"),x.scrollTo(c),b=!0):b=!1;b||p(g.getPullRequest(),a.type,a.id)}}function t(){var a=new v(window.location);return{type:a.getQueryParamValue("commentId")?"comment":"activity",id:a.getQueryParamValue("commentId")||a.getQueryParamValue("activityId")}}
var e,c,h,k=!1,u,A={COMMENT:"comment",ACTIVITY:"activity"};f.on("bitbucket.internal.pull-request.cant.merge",function(a,b,c){!k&&b&&e&&(k=!0,n(e))});return{load:function(a){e=a;var b=g.getPullRequest();a.innerHTML=bitbucket.internal.page.pullRequest.viewOverview({pullRequest:b.toJSON(),author:b.getAuthor().getUser().toJSON(),createdDate:b.getCreatedDate(),description:b.getDescription(),descriptionAsHtml:b.getDescriptionAsHtml(),currentUser:g.getCurrentUser()&&g.getCurrentUser().toJSON(),commentTips:l.tips});
y.container(d(a));k&&n(a);u=b.getParticipants();h=new w(u,d("#participants-dropdown ul"),d(".participants.plugin-item"));a=t();p(b,a.type,a.id);f.on("bitbucket.internal.history.changestate",r)},_internalActivity:function(){return c},unload:function(a){c.reset();c=null;d(a).empty();e=null;h.destroy();h=null;f.off("bitbucket.internal.history.changestate",r)},keyboardShortcutContexts:["pull-request-overview"]}});