define("bitbucket/internal/impl/web-fragments",["lodash","bitbucket/internal/bbui/web-fragments/web-fragments","bitbucket/internal/util/object"],function(g,h,l){function k(b){return g.transform(b,function(a,b,d){a[d]=b&&b._stash?b._stash:b},{})}function c(){h.default.apply(this,arguments);this._handlers={}}function e(b,a,c){return function(d,f){return this._handlers[d]?this._handlers[d](d,[b],k(f),f):window.WebFragments[a](d,k(f)).map(c.bind(null,d))}}l.inherits(c,h.default);c.prototype.getWebItems=
e("ITEM","getWebItems",function(b,a){return{type:"ITEM",weight:a.weight,location:b,url:a.url,key:a.moduleKey,text:a.linkText,params:a.params,id:a.linkId,cssClass:a.styleClass,tooltip:a.tooltip,iconUrl:a.iconUrl||null,iconWidth:a.iconWidth||0,iconHeight:a.iconHeight||0,description:a.description}});c.prototype.getWebSections=e("SECTION","getWebSections",function(b,a){return{type:"SECTION",weight:a.weight,location:b,key:a.key,text:a.labelText,params:a.params,description:a.description}});c.prototype.getWebPanels=
e("PANEL","_getWebPanels",function(b,a){return{type:"PANEL",weight:a.weight,location:b,key:a.key,html:a.view,params:a.params,description:a.description}});c.prototype.getWebFragments=function(b,a,c){var d=this;return g(a).map(function(a){switch(a){case "ITEM":return d.getWebItems(b,c);case "SECTION":return d.getWebSections(b,c);case "PANEL":return d.getWebPanels(b,c)}}).flatten().sortBy("weight").value()};c.prototype.registerHandler=function(b,a){if(this._handlers[b])throw Error("Location "+b+" is being double handled.");
this._handlers[b]=a};return new c});