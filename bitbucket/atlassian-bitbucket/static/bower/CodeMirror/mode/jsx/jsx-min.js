(function(d){"object"==typeof exports&&"object"==typeof module?d(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],d):d(CodeMirror)})(function(d){function l(d,l,n,p){this.state=d;this.mode=l;this.depth=n;this.prev=p}function q(g){return new l(d.copyState(g.mode,g.state),g.mode,g.depth,g.prev&&q(g.prev))}d.defineMode("jsx",function(g,m){function n(b){var c=
b.tagName;b.tagName=null;var a=h.indent(b,"");b.tagName=c;return a}function p(b,c){if(c.context.mode==h)return r(b,c,c.context);var a;a=c.context;if("\x3c"==b.peek()&&k.expressionAllowed(b,a.state))k.skipExpression(a.state),c.context=new l(d.startState(h,k.indent(a.state,"")),h,0,c.context),a=null;else{var f=k.token(b,a.state);if(!f&&null!=a.depth){var e=b.current();"{"==e?a.depth++:"}"==e&&0==--a.depth&&(c.context=c.context.prev)}a=f}return a}function r(b,c,a){if(2==a.depth)return b.match(/^.*?\*\//)?
a.depth=1:b.skipToEnd(),"comment";if("{"==b.peek()){h.skipAttribute(a.state);var f=n(a.state),e=a.state.context;if(e&&b.match(/^[^>]*>\s*$/,!1)){for(;e.prev&&!e.startOfLine;)e=e.prev;e.startOfLine?f-=g.indentUnit:a.prev.state.lexical&&(f=a.prev.state.lexical.indented)}else 1==a.depth&&(f+=g.indentUnit);c.context=new l(d.startState(k,f),k,0,c.context);return null}if(1==a.depth){if("\x3c"==b.peek())return h.skipAttribute(a.state),c.context=new l(d.startState(h,n(a.state)),h,0,c.context),null;if(b.match("//"))return b.skipToEnd(),
"comment";if(b.match("/*"))return a.depth=2,p(b,c)}var f=h.token(b,a.state),e=b.current(),m;/\btag\b/.test(f)?/>$/.test(e)?a.state.context?a.depth=0:c.context=c.context.prev:/^</.test(e)&&(a.depth=1):!f&&-1<(m=e.indexOf("{"))&&b.backUp(e.length-m);return f}var h=d.getMode(g,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1}),k=d.getMode(g,m&&m.base||"javascript");return{startState:function(){return{context:new l(d.startState(k),k)}},copyState:function(b){return{context:q(b.context)}},token:p,
indent:function(b,c,a){return b.context.mode.indent(b.context.state,c,a)},innerMode:function(b){return b.context}}},"xml","javascript");d.defineMIME("text/jsx","jsx")});